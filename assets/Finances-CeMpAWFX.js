import{c as F,b as re,r as c,s as p,j as e,F as le,A as M,M as I}from"./index-c2uMsRJE.js";import{D as oe,E as ne}from"./jspdf.es.min-DWMMRYN6.js";import{P as ie}from"./plus-ifN5Q_C4.js";import{D as ce,B as de}from"./dollar-sign-D4NVPYhl.js";import{C as xe}from"./clock-Dc9eE_j_.js";import{S as me}from"./search-WKGUOpbI.js";import{T as pe}from"./trash-2-BX8K8e1r.js";import{C as ue}from"./calendar-BJIiVXMv.js";const be=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],K=F("funnel",be);const he=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],D=F("trending-down",he);const ge=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],N=F("trending-up",ge),De=()=>{const{profile:k}=re(),[B,C]=c.useState(!0),[u,J]=c.useState({revenue:0,expenses:0,profit:0}),[w,q]=c.useState([]),[G,_]=c.useState(!1),[Y,U]=c.useState([]),[n,b]=c.useState({amount:"",description:"",category:"parts",date:new Date().toISOString().split("T")[0],job_id:""}),[H,E]=c.useState(!1),[h,W]=c.useState("monthly"),[x,v]=c.useState({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[R,L]=c.useState(!1),[Q,V]=c.useState([]),y=c.useCallback(async s=>{C(!0);try{const{data:t,error:d}=await p.from("job_cards").select("id, estimated_cost_lkr, created_at, completed_at").eq("status","completed").abortSignal(s);if(d)throw d;const a=t?.reduce((r,j)=>r+(Number(j.estimated_cost_lkr)||0),0)||0;V(t||[]);const{data:g,error:m}=await p.from("user_expenses").select("*, profiles!user_id(full_name), job_cards(vehicles(license_plate))").order("date",{ascending:!1}).abortSignal(s);if(m)throw m;const{data:f,error:l}=await p.from("job_parts").select("*, parts(cost_lkr, name), job_cards!inner(status, vehicles(license_plate))").eq("job_cards.status","completed");l&&console.warn("[Finances] Parts cost fetch error:",l);const{data:o,error:i}=await p.from("job_labor").select("*, job_cards!inner(status, vehicles(license_plate))").eq("job_cards.status","completed");i&&console.warn("[Finances] Labor cost fetch error:",i);const{data:P}=await p.from("tenants").select("default_labor_rate").single(),se=P?.default_labor_rate?Number(P.default_labor_rate):1500,ae=[...(f||[]).map(r=>({id:`jp-${r.id}`,date:r.created_at,description:`Part: ${r.parts?.name||r.custom_name||"Item"}`,category:"parts",amount_lkr:(Number(r.parts?.cost_lkr)||0)*(r.quantity||1),profiles:{full_name:"Job System"},job_cards:r.job_cards,is_automatic:!0})),...(o||[]).map(r=>({id:`jl-${r.id}`,date:r.created_at,description:`Labor: ${r.description||"Service"}`,category:"labor",amount_lkr:(Number(r.hours)||0)*se,profiles:{full_name:r.mechanic_name||"Technician"},job_cards:r.job_cards,is_automatic:!0}))],O=[...(g||[]).map(r=>({...r,is_automatic:!1})),...ae].sort((r,j)=>new Date(j.date).getTime()-new Date(r.date).getTime()),A=O.reduce((r,j)=>r+(Number(j.amount_lkr)||0),0);J({revenue:a,expenses:A,profit:a-A}),q(O)}catch(t){t.name!=="AbortError"&&(console.error("[Finances Fetch Error]",t),alert("Financial Sync Failed: "+t.message))}finally{s?.aborted||C(!1)}},[]),X=c.useCallback(async()=>{const{data:s}=await p.from("job_cards").select("*, vehicles(license_plate, make, model)").in("status",["pending","in_progress","waiting_parts"]).order("created_at",{ascending:!1});U(s||[])},[]);c.useEffect(()=>{const s=new AbortController;return y(s.signal),X(),()=>s.abort()},[y]);const[z,$]=c.useState(!1),Z=async s=>{s.preventDefault(),$(!0);const{error:t}=await p.from("user_expenses").insert({user_id:k?.id,tenant_id:k?.tenant_id,amount_lkr:parseFloat(n.amount),description:n.description,category:n.category,date:n.date,job_id:n.job_id||null});t?alert("Error: "+t.message):(_(!1),b({amount:"",description:"",category:"parts",date:new Date().toISOString().split("T")[0],job_id:""}),y()),$(!1)},ee=async s=>{if(!confirm("Delete this expense?"))return;const{error:t}=await p.from("user_expenses").delete().eq("id",s);t?alert(t.message):y()},S=s=>{W(s);const t=new Date;if(s==="monthly"){const d=new Date(t.getFullYear(),t.getMonth(),1),a=new Date(t.getFullYear(),t.getMonth()+1,0);v({startDate:d.toISOString().split("T")[0],endDate:a.toISOString().split("T")[0]})}else if(s==="annual"){const d=new Date(t.getFullYear(),0,1),a=new Date(t.getFullYear(),11,31);v({startDate:d.toISOString().split("T")[0],endDate:a.toISOString().split("T")[0]})}},T=()=>{const s=new Date(x.startDate),t=new Date(x.endDate);t.setHours(23,59,59,999);const d=Q.filter(o=>{const i=new Date(o.completed_at||o.created_at);return i>=s&&i<=t}),a=w.filter(o=>{const i=new Date(o.date);return i>=s&&i<=t}),g=d.reduce((o,i)=>o+(Number(i.estimated_cost_lkr)||0),0),m=a.reduce((o,i)=>o+(Number(i.amount_lkr)||0),0),f=g-m,l={};return a.forEach(o=>{const i=o.category||"other";l[i]=(l[i]||0)+Number(o.amount_lkr)}),{revenue:g,expenses:m,profit:f,jobCount:d.length,expenseCount:a.length,categoryBreakdown:l,filteredExpenses:a}},te=()=>{L(!0);try{const s=T(),t=new ne;t.setFontSize(20),t.setFont("helvetica","bold"),t.text("AutoPulse OS",105,20,{align:"center"}),t.setFontSize(14),t.text("Financial Report",105,30,{align:"center"}),t.setFontSize(10),t.setFont("helvetica","normal");const d=h==="monthly"?"Monthly Report":h==="annual"?"Annual Report":"Custom Period Report";t.text(`${d}: ${x.startDate} to ${x.endDate}`,105,38,{align:"center"}),t.text(`Generated: ${new Date().toLocaleDateString()} ${new Date().toLocaleTimeString()}`,105,44,{align:"center"});let a=60;t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Financial Summary",20,a),a+=10,t.setFontSize(10),t.setFont("helvetica","normal"),t.setDrawColor(34,197,94),t.setFillColor(240,253,244),t.rect(20,a,55,25,"FD"),t.setFont("helvetica","bold"),t.text("Total Revenue",25,a+8),t.setFontSize(14),t.text(`LKR ${s.revenue.toLocaleString()}`,25,a+18),t.setDrawColor(239,68,68),t.setFillColor(254,242,242),t.rect(80,a,55,25,"FD"),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("Total Expenses",85,a+8),t.setFontSize(14),t.text(`LKR ${s.expenses.toLocaleString()}`,85,a+18);const g=s.profit>=0?[34,197,94]:[239,68,68];t.setDrawColor(...g),t.setFillColor(s.profit>=0?240:254,s.profit>=0?253:242,s.profit>=0?244:242),t.rect(140,a,55,25,"FD"),t.setFontSize(10),t.setFont("helvetica","bold"),t.text("Net Profit",145,a+8),t.setFontSize(14),t.text(`LKR ${s.profit.toLocaleString()}`,145,a+18),a+=35,t.setFontSize(10),t.setFont("helvetica","normal"),t.text(`Completed Jobs: ${s.jobCount}`,20,a),t.text(`Total Expenses Recorded: ${s.expenseCount}`,20,a+6),a+=20,t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Expense Breakdown by Category",20,a),a+=8,t.setFontSize(10),t.setFont("helvetica","normal"),Object.entries(s.categoryBreakdown).forEach(([l,o])=>{t.text(`${l.charAt(0).toUpperCase()+l.slice(1)}: LKR ${o.toLocaleString()}`,25,a),a+=6}),a+=10,a>250&&(t.addPage(),a=20),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Detailed Expense Log",20,a),a+=8,t.setFontSize(8),t.setFont("helvetica","bold"),t.text("Date",20,a),t.text("Description",45,a),t.text("Category",120,a),t.text("Amount (LKR)",160,a),a+=2,t.setDrawColor(200,200,200),t.line(20,a,195,a),a+=5,t.setFont("helvetica","normal"),s.filteredExpenses.forEach(l=>{a>280&&(t.addPage(),a=20),t.text(new Date(l.date).toLocaleDateString(),20,a);const o=l.description.length>35?l.description.substring(0,32)+"...":l.description;t.text(o,45,a),t.text(l.category,120,a),t.text(l.amount_lkr.toLocaleString(),160,a),a+=6}),s.filteredExpenses.length>30&&(a+=5,t.setFont("helvetica","italic"),t.text(`... and ${s.filteredExpenses.length-30} more expenses`,20,a));const m=t.getNumberOfPages();for(let l=1;l<=m;l++)t.setPage(l),t.setFontSize(8),t.setFont("helvetica","normal"),t.setTextColor(150,150,150),t.text(`Page ${l} of ${m}`,105,290,{align:"center"}),t.text("AutoPulse OS - Workshop Management System",105,285,{align:"center"});const f=`Financial_Report_${h}_${x.startDate}_to_${x.endDate}.pdf`;t.save(f),alert("Report generated successfully!")}catch(s){console.error("PDF Generation Error:",s),alert("Failed to generate PDF report. Please try again.")}finally{L(!1)}};return e.jsxs("div",{className:"p-2 space-y-8 h-[calc(100vh-100px)] flex flex-col overflow-y-auto",children:[B&&e.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-50 flex items-center gap-3 bg-slate-900/90 border border-cyan-500/20 px-4 py-2 rounded-full backdrop-blur shadow-xl animate-fade-in",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-cyan-500 border-t-transparent"}),e.jsx("span",{className:"text-cyan-400 text-xs font-bold uppercase tracking-widest",children:"Updating Finances..."})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Financial Overview"}),e.jsx("p",{className:"text-slate-400",children:"Track revenue, expenses, and profitability."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2 bg-cyan-600 hover:bg-cyan-500 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-cyan-500/20 transition-all active:scale-95",children:[e.jsx(le,{size:20})," Generate Report"]}),e.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-2 bg-emerald-600 hover:bg-emerald-500 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-emerald-500/20 transition-all active:scale-95",children:[e.jsx(ie,{size:20})," Add Expense"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-6 rounded-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 text-emerald-500/10",children:e.jsx(N,{size:64})}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 mb-4",children:[e.jsx(ce,{size:20,className:"text-emerald-400"}),e.jsx("span",{className:"text-sm font-medium uppercase tracking-wider",children:"Total Revenue"})]}),e.jsxs("div",{className:"text-3xl font-black text-white font-mono",children:["LKR ",u.revenue.toLocaleString()]}),e.jsxs("div",{className:"mt-2 text-xs text-emerald-400 flex items-center gap-1",children:[e.jsx(N,{size:12})," Based on completed jobs"]})]}),e.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-6 rounded-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 text-rose-500/10",children:e.jsx(D,{size:64})}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 mb-4",children:[e.jsx(D,{size:20,className:"text-rose-400"}),e.jsx("span",{className:"text-sm font-medium uppercase tracking-wider",children:"Total Expenses"})]}),e.jsxs("div",{className:"text-3xl font-black text-white font-mono",children:["LKR ",u.expenses.toLocaleString()]}),e.jsxs("div",{className:"mt-2 text-xs text-rose-400 flex items-center gap-1",children:[e.jsx(D,{size:12})," Shop overheads & parts"]})]}),e.jsxs("div",{className:`bg-slate-900/50 border p-6 rounded-2xl relative overflow-hidden transition-colors ${u.profit>=0?"border-emerald-500/20":"border-rose-500/20"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 text-white/5",children:e.jsx(M,{size:64})}),e.jsxs("div",{className:"flex items-center gap-3 text-slate-400 mb-4",children:[e.jsx(N,{size:20,className:u.profit>=0?"text-emerald-400":"text-rose-400"}),e.jsx("span",{className:"text-sm font-medium uppercase tracking-wider",children:"Net Profit"})]}),e.jsxs("div",{className:`text-3xl font-black font-mono ${u.profit>=0?"text-emerald-400":"text-rose-400"}`,children:["LKR ",u.profit.toLocaleString()]}),e.jsx("div",{className:"mt-2 text-xs text-slate-500",children:u.profit>=0?"Profitable operation":"Negative margin"})]})]}),e.jsxs("div",{className:"flex-1 bg-slate-900/50 border border-slate-800 rounded-2xl flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-slate-800 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:[e.jsx(xe,{size:20,className:"text-cyan-400"})," Expense Log"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(me,{className:"absolute left-3 top-2.5 text-slate-500",size:16}),e.jsx("input",{type:"text",placeholder:"Search expenses...",className:"bg-slate-800 border border-slate-700 rounded-lg py-2 pl-9 pr-4 text-xs text-white focus:outline-none focus:border-cyan-500 w-full md:w-64"})]}),e.jsx("button",{className:"p-2 bg-slate-800 text-slate-400 rounded-lg hover:text-white transition-colors border border-slate-700",children:e.jsx(K,{size:18})})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-950/50 text-slate-400 uppercase text-[10px] font-bold tracking-widest",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Description"}),e.jsx("th",{className:"px-6 py-4",children:"Category"}),e.jsx("th",{className:"px-6 py-4",children:"Logged By"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Amount (LKR)"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y divide-slate-800",children:[w.map(s=>e.jsxs("tr",{className:"hover:bg-slate-800/30 transition-colors group",children:[e.jsx("td",{className:"px-6 py-4 text-slate-400",children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 font-medium text-white",children:[s.description,s.job_id&&e.jsx("div",{className:"flex items-center gap-1 mt-1",children:e.jsxs("span",{className:"text-[10px] bg-cyan-900/30 text-cyan-400 border border-cyan-900/50 px-1.5 py-0.5 rounded flex items-center w-fit",children:[e.jsx(de,{size:10,className:"mr-1"}),s.job_cards?.vehicles?.license_plate||"Linked Job"]})})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-md text-[10px] font-bold uppercase ${s.category==="parts"?"bg-purple-500/10 text-purple-400":s.category==="utility"?"bg-blue-500/10 text-blue-400":"bg-slate-700 text-slate-300"}`,children:s.category})}),e.jsx("td",{className:"px-6 py-4 text-slate-500",children:s.profiles?.full_name||"System"}),e.jsx("td",{className:"px-6 py-4 text-right font-mono font-bold text-white",children:s.amount_lkr.toLocaleString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>ee(s.id),className:"text-slate-600 hover:text-rose-500 transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(pe,{size:16})})})]},s.id)),w.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-10 text-center text-slate-500 italic",children:"No expenses recorded yet."})})]})]})})]}),e.jsx(I,{isOpen:G,onClose:()=>_(!1),title:"Record New Expense",children:e.jsxs("form",{onSubmit:Z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Description"}),e.jsx("input",{required:!0,type:"text",className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none",placeholder:"e.g. Shop Electricity Bill",value:n.description,onChange:s=>b({...n,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Amount (LKR)"}),e.jsx("input",{required:!0,type:"number",className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none font-mono",value:n.amount,onChange:s=>b({...n,amount:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Date"}),e.jsx("input",{required:!0,type:"date",className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none",value:n.date,onChange:s=>b({...n,date:s.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Category"}),e.jsxs("select",{className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none",value:n.category,onChange:s=>b({...n,category:s.target.value}),children:[e.jsx("option",{value:"parts",children:"Parts Purchase"}),e.jsx("option",{value:"utility",children:"Utilities & Rent"}),e.jsx("option",{value:"marketing",children:"Marketing"}),e.jsx("option",{value:"salary",children:"Salaries"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Link to Job (Optional)"}),e.jsxs("select",{className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none text-sm",value:n.job_id,onChange:s=>b({...n,job_id:s.target.value}),children:[e.jsx("option",{value:"",children:"-- General Expense --"}),Y.map(s=>e.jsxs("option",{value:s.id,children:[s.vehicles?.license_plate," - ",s.vehicles?.make," ",s.vehicles?.model]},s.id))]})]}),e.jsx("button",{type:"submit",disabled:z,className:"w-full bg-emerald-600 hover:bg-emerald-500 text-white py-3 rounded-xl font-bold transition-all shadow-lg shadow-emerald-500/20 disabled:opacity-50 flex items-center justify-center gap-2",children:z?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white/20 border-t-white"}),"RECORDING..."]}):"Confirm Expense"})]})}),e.jsx(I,{isOpen:H,onClose:()=>E(!1),title:"Generate Financial Report",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-3 font-medium",children:"Report Type"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>S("monthly"),className:`p-4 rounded-xl border-2 transition-all ${h==="monthly"?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[e.jsx(ue,{size:20,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-xs font-bold",children:"Monthly"})]}),e.jsxs("button",{type:"button",onClick:()=>S("annual"),className:`p-4 rounded-xl border-2 transition-all ${h==="annual"?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[e.jsx(N,{size:20,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-xs font-bold",children:"Annual"})]}),e.jsxs("button",{type:"button",onClick:()=>S("custom"),className:`p-4 rounded-xl border-2 transition-all ${h==="custom"?"border-cyan-500 bg-cyan-500/10 text-cyan-400":"border-slate-700 bg-slate-800 text-slate-400 hover:border-slate-600"}`,children:[e.jsx(K,{size:20,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-xs font-bold",children:"Custom"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none",value:x.startDate,onChange:s=>v({...x,startDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-slate-400 mb-1",children:"End Date"}),e.jsx("input",{type:"date",className:"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 text-white focus:border-cyan-500 focus:outline-none",value:x.endDate,onChange:s=>v({...x,endDate:s.target.value})})]})]}),e.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-xl p-4",children:[e.jsxs("h4",{className:"text-sm font-bold text-white mb-3 flex items-center gap-2",children:[e.jsx(M,{size:16,className:"text-cyan-400"}),"Report Preview"]}),(()=>{const s=T();return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-slate-950 rounded-lg p-3 border border-emerald-500/20",children:[e.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider mb-1",children:"Revenue"}),e.jsxs("div",{className:"text-emerald-400 font-bold font-mono text-sm",children:["LKR ",s.revenue.toLocaleString()]})]}),e.jsxs("div",{className:"bg-slate-950 rounded-lg p-3 border border-rose-500/20",children:[e.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider mb-1",children:"Expenses"}),e.jsxs("div",{className:"text-rose-400 font-bold font-mono text-sm",children:["LKR ",s.expenses.toLocaleString()]})]}),e.jsxs("div",{className:`bg-slate-950 rounded-lg p-3 border ${s.profit>=0?"border-emerald-500/20":"border-rose-500/20"}`,children:[e.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider mb-1",children:"Profit"}),e.jsxs("div",{className:`font-bold font-mono text-sm ${s.profit>=0?"text-emerald-400":"text-rose-400"}`,children:["LKR ",s.profit.toLocaleString()]})]})]}),e.jsxs("div",{className:"text-xs text-slate-400 flex items-center justify-between",children:[e.jsxs("span",{children:[s.jobCount," completed jobs"]}),e.jsxs("span",{children:[s.expenseCount," expense records"]})]}),Object.keys(s.categoryBreakdown).length>0&&e.jsxs("div",{className:"border-t border-slate-800 pt-3 mt-3",children:[e.jsx("div",{className:"text-[10px] text-slate-500 uppercase tracking-wider mb-2",children:"Expense Categories"}),e.jsx("div",{className:"space-y-1",children:Object.entries(s.categoryBreakdown).map(([t,d])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-slate-400 capitalize",children:t}),e.jsxs("span",{className:"text-white font-mono",children:["LKR ",d.toLocaleString()]})]},t))})]})]})})()]}),e.jsx("button",{onClick:te,disabled:R,className:"w-full bg-cyan-600 hover:bg-cyan-500 text-white py-3 rounded-xl font-bold transition-all shadow-lg shadow-cyan-500/20 disabled:opacity-50 flex items-center justify-center gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white/20 border-t-white"}),"GENERATING PDF..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:20}),"Download PDF Report"]})}),e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"Report will include summary, category breakdown, and detailed expense log"})]})})]})};export{De as Finances};
